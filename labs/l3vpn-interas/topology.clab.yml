name: l3vpn-interas-option-a
prefix: ""

mgmt:
  network: internalnet
  ipv4-subnet: 192.168.101.0/24

topology:
  kinds:
    ceos:
      image: ceos:4.34.1F

  nodes:
  # -------------------------------- #
  # AS 65000 Core P routers
    a-p01:
      kind: ceos
      mgmt-ipv4: 192.168.101.111
      startup-config: l3vpn-configs/a-p01.cfg
      env:
        TMODE: lacp
    a-p02:
      kind: ceos
      mgmt-ipv4: 192.168.101.112
      startup-config: l3vpn-configs/a-p02.cfg
      env:
        TMODE: lacp

  # -------------------------------- #
  # AS 65001 Core P routers
    b-p01:
      kind: ceos
      mgmt-ipv4: 192.168.101.121
      startup-config: l3vpn-configs/b-p01.cfg
      env:
        TMODE: lacp
    b-p02:
      kind: ceos
      mgmt-ipv4: 192.168.101.122
      startup-config: l3vpn-configs/b-p02.cfg
      env:
        TMODE: lacp

  # -------------------------------- #
  # AS 65000 PE routers
    a-pe01:
      kind: ceos
      mgmt-ipv4: 192.168.101.11
      startup-config: l3vpn-configs/a-pe01.cfg
      env:
        TMODE: lacp
    a-pe02:
      kind: ceos
      mgmt-ipv4: 192.168.101.12
      startup-config: l3vpn-configs/a-pe02.cfg
      env:
        TMODE: lacp

  # -------------------------------- #
  # AS 65001 PE routers
    b-pe01:
      kind: ceos
      mgmt-ipv4: 192.168.101.21
      startup-config: l3vpn-configs/b-pe01.cfg
      env:
        TMODE: lacp

  # -------------------------------- #
  # ASBR routers (Inter-AS connectivity)
    a-asbr:
      kind: ceos
      mgmt-ipv4: 192.168.101.13
      startup-config: l3vpn-configs/a-asbr.cfg
      env:
        TMODE: lacp
    b-asbr:
      kind: ceos
      mgmt-ipv4: 192.168.101.22
      startup-config: l3vpn-configs/b-asbr.cfg
      env:
        TMODE: lacp

  # -------------------------------- #
  # Site 1 CE (AS 65000)
    a-ce01:
      kind: ceos
      mgmt-ipv4: 192.168.101.211
      startup-config: l3vpn-configs/a-ce01.cfg
      env:
        TMODE: lacp

  # -------------------------------- #
  # Site 2 CE (AS 65001)
    b-ce01:
      kind: ceos
      mgmt-ipv4: 192.168.101.221
      startup-config: l3vpn-configs/b-ce01.cfg
      env:
        TMODE: lacp

  links:
  # -------------------------------- #
  # AS 65000 Core network
    - endpoints: ["a-p01:eth5", "a-p02:eth5"]
    - endpoints: ["a-pe01:eth1", "a-p01:eth1"]
    - endpoints: ["a-pe01:eth2", "a-p02:eth1"]
    - endpoints: ["a-pe02:eth1", "a-p01:eth2"]
    - endpoints: ["a-pe02:eth2", "a-p02:eth2"]
    - endpoints: ["a-asbr:eth1", "a-p01:eth3"]
    - endpoints: ["a-asbr:eth2", "a-p02:eth3"]

  # -------------------------------- #
  # AS 65001 Core network
    - endpoints: ["b-p01:eth5", "b-p02:eth5"]
    - endpoints: ["b-pe01:eth1", "b-p01:eth1"]
    - endpoints: ["b-pe01:eth2", "b-p02:eth1"]
    - endpoints: ["b-asbr:eth1", "b-p01:eth3"]
    - endpoints: ["b-asbr:eth2", "b-p02:eth3"]

  # -------------------------------- #
  # Inter-AS link (Option A: Back-to-back VRFs)
    - endpoints: ["a-asbr:eth3", "b-asbr:eth3"]

  # -------------------------------- #
  # CE connections
    - endpoints: ["a-ce01:eth1", "a-pe01:eth4"]
    - endpoints: ["a-ce01:eth2", "a-pe02:eth4"]
    - endpoints: ["b-ce01:eth1", "b-pe01:eth3"]
